/* Floating Action Button with precise d10 silhouette */
.fab {
  --tint: #8a0f1a;

  position: fixed;
  right: calc(clamp(12px, 2vw, 18px) + env(safe-area-inset-right, 0px));
  bottom: calc(clamp(12px, 2vw, 18px) + env(safe-area-inset-bottom, 0px));
  width: 72px;
  height: 72px;

  /* The actual d10 clipping (same points as the SVG outline) */
  clip-path: polygon(
    8% 22%,
    32% 8%,
    68% 8%,
    92% 22%,
    100% 58%,
    74% 98%,
    26% 98%,
    0% 58%
  );

  background:
    radial-gradient(120% 120% at 30% 18%, rgba(255,255,255,.10), transparent 40%),
    linear-gradient(180deg, #262626, #1b1b1b);
  border: none; /* stroke comes from the SVG on top */

  display: grid;
  place-items: center;
  cursor: pointer;
  z-index: 980;

  box-shadow:
    0 14px 34px rgba(0,0,0,.6),
    0 0 0 2px rgba(0,0,0,.35) inset;
  transition: transform .08s ease, filter .2s ease, box-shadow .2s ease;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

.fab:hover { filter: brightness(1.07); }
.fab:active { transform: translateY(1px) scale(.985); }

.fabOpen {
  box-shadow:
    0 18px 44px rgba(0,0,0,.68),
    0 0 0 3px color-mix(in oklab, var(--tint) 45%, transparent) inset;
}

/* SVG outline overlays the clipped button to draw bold edges/facets */
.d10Outline {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  /* A subtle glow so the black lines read on very dark backgrounds */
  filter: drop-shadow(0 1px 2px rgba(255,255,255,.05))
          drop-shadow(0 2px 8px rgba(0,0,0,.6));
}

/* Centered ankh icon */
.fabIcon {
  width: 40px;
  height: 40px;
  object-fit: contain;
  pointer-events: none;
  filter: drop-shadow(0 1px 3px rgba(0,0,0,.6));
}

/* Sliding panel */
.panel {
  position: fixed;
  right: calc(clamp(12px, 2vw, 18px) + env(safe-area-inset-right, 0px));
  left: auto;
  bottom: calc(clamp(12px, 2vw, 18px) + 62px + env(safe-area-inset-bottom, 0px));
  width: min(520px, 92vw);
  max-height: 70dvh;
  display: grid;
  grid-template-rows: auto auto 1fr auto;
  gap: 10px;
  padding: 12px;
  background:
    radial-gradient(900px 140px at 10% -10%, color-mix(in oklab, #8a0f1a 14%, transparent), transparent 60%),
    linear-gradient(180deg, #1d1d1d, #181818);
  border: 1px solid #333;
  border-radius: 14px;
  box-shadow: 0 22px 60px rgba(0,0,0,.65);
  color: #e6e6e6;
  transform: translateY(8px);
  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease, transform .18s ease;
  z-index: 970;
  overscroll-behavior: contain;
}
.open {
  transform: translateY(0);
  opacity: 1;
  pointer-events: auto;
}

/* Header */
.headRow {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 8px;
}
.title {
  font-weight: 700;
  letter-spacing: .3px;
  font-size: 1.02rem;
}
.iconBtn {
  appearance: none;
  background: #262626;
  border: 1px solid #333;
  color: #e6e6e6;
  padding: 6px 10px;
  border-radius: 10px;
  cursor: pointer;
}

/* Inputs row */
.inputs {
  display: grid;
  grid-template-columns: repeat(8, 1fr);
  gap: 8px;
  align-items: end;
}
.inputGroup { grid-column: span 2; display: grid; gap: 4px; }
.inputGroup label { color: #a1a1a1; font-size: .9rem; }
.input {
  width: 100%;
  background: #262626;
  border: 1px solid #333;
  border-radius: 10px;
  padding: 8px 10px;
  color: #e6e6e6;
  outline: none;
}
.input:focus { border-color: color-mix(in oklab, #8a0f1a 45%, #333); }
.rollBtn {
  grid-column: span 2;
  background: linear-gradient(180deg, color-mix(in oklab, #8a0f1a 78%, #000), color-mix(in oklab, #8a0f1a 64%, #000));
  border: 1px solid color-mix(in oklab, #8a0f1a 70%, #000);
  color: #fff;
  padding: 9px 10px;
  border-radius: 10px;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 6px 18px color-mix(in oklab, #8a0f1a 25%, transparent);
}

/* Result banner */
.resultRow {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 10px;
  align-items: center;
  background: #1f1f1f;
  border: 1px solid #333;
  border-radius: 12px;
  padding: 8px;
}
.resultArt {
  width: 54px;
  height: 54px;
  object-fit: contain;
  border-radius: 10px;
  background: #5f5f5f;
  border: 1px solid #2c2c2c;
  box-shadow: 0 6px 18px rgba(0,0,0,.45);
}
.resultText { display: grid; gap: 2px; }
.resultTitle { font-weight: 800; letter-spacing: .3px; }
.resultMeta { color: #a1a1a1; font-size: .95rem; }

/* Dice pools */
.diceRows {
  display: grid;
  gap: 8px;
  overflow: auto;
}
.poolBlock { display: grid; gap: 6px; }
.poolLabel { color: #a1a1a1; font-size: .92rem; }
.poolDice { display: flex; flex-wrap: wrap; gap: 8px; }

.die {
  width: 38px;
  height: 38px;
  border-radius: 10px;
  border: 1px solid #3a3a3a;
  background:
    radial-gradient(120% 120% at 30% 20%, rgba(255,255,255,.08), transparent 40%),
    #232323;
  color: #e9e9e9;
  display: grid;
  place-items: center;
  font-weight: 800;
  letter-spacing: .2px;
  box-shadow: 0 8px 16px rgba(0,0,0,.35);
  user-select: none;
}
.hunger {
  border-color: #661319;
  box-shadow: 0 8px 16px rgba(138, 15, 26, .25);
}
.fail { opacity: .7; }
.success { outline: 1px solid rgba(90, 168, 110, .5); }
.ten {
  color: #ffe3a6;
  outline: 1px solid rgba(240, 200, 120, .5);
  box-shadow: 0 0 0 1px rgba(240, 200, 120, .25) inset;
}

/* WP selection */
.selectable {
  cursor: pointer;
  transition: transform .08s ease, outline-color .12s ease;
}
.selectable:hover { transform: translateY(-1px); }
.selected {
  outline: 2px solid color-mix(in oklab, #8a0f1a 75%, #000);
  box-shadow: 0 0 0 2px rgba(0,0,0,.4) inset, 0 10px 22px rgba(138, 15, 26, .25);
}

/* WP row */
.wpRow {
  display: grid;
  grid-template-columns: auto auto 1fr;
  align-items: center;
  gap: 8px;
}
.wpBtn {
  background: #262626;
  border: 1px solid #333;
  color: #f1f1f1;
  padding: 8px 12px;
  border-radius: 10px;
  cursor: pointer;
}
.wpBtn:disabled { opacity: .5; cursor: not-allowed; }
.confirmBtn {
  background: linear-gradient(180deg, color-mix(in oklab, #8a0f1a 78%, #000), color-mix(in oklab, #8a0f1a 64%, #000));
  border: 1px solid color-mix(in oklab, #8a0f1a 70%, #000);
  color: #fff;
  padding: 8px 12px;
  border-radius: 10px;
  font-weight: 700;
  cursor: pointer;
}
.confirmBtn:disabled { opacity: .5; cursor: not-allowed; }
.note { color: #a1a1a1; justify-self: end; }

/* ======= Mobile tuning ======= */
@media (max-width: 520px) {
  .fab {
    width: 60px;
    height: 60px;
  }
  .fabIcon { width: 34px; height: 34px; }

  .panel {
    left: calc(clamp(12px, 2vw, 18px) + env(safe-area-inset-left, 0px));
    right: calc(clamp(12px, 2vw, 18px) + env(safe-area-inset-right, 0px));
    width: auto;
    max-height: 75dvh;
  }

  .inputs {
    grid-template-columns: repeat(6, 1fr);
  }
  .inputGroup { grid-column: span 3; }
  .rollBtn { grid-column: span 6; }

  .resultArt { width: 48px; height: 48px; }

  .die { width: 34px; height: 34px; }

  .wpRow {
    grid-template-columns: 1fr 1fr;
  }
  .note {
    grid-column: 1 / -1;
    justify-self: start;
    margin-top: 2px;
  }
}

/* Extra-small screens & landscape keyboards */
@media (max-width: 380px) {
  .fab { width: 56px; height: 56px; }
  .fabIcon { width: 30px; height: 30px; }
  .die { width: 32px; height: 32px; }
  .panel { max-height: 78dvh; }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .fab,
  .panel,
  .selectable {
    transition: none;
  }
}
